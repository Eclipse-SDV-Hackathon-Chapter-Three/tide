<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FASLit System Architecture</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #0f172a 100%);
  padding: 40px;
  min-height: 100vh;
}
.container { max-width: 1600px; margin: 0 auto; }
.header { text-align: center; margin-bottom: 40px; }
.header h1 { color: white; font-size: 42px; margin-bottom: 10px; font-weight: 700; }
.header p { color: #93c5fd; font-size: 20px; }
.grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin-bottom: 24px; }
.card { 
  border-radius: 12px; 
  padding: 24px; 
  border: 2px solid;
  box-shadow: 0 20px 25px -5px rgba(0,0,0,0.5);
}
.card-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
.card-title { color: white; font-size: 20px; font-weight: 700; }
.section { 
  background: #1e293b; 
  border-radius: 8px; 
  padding: 16px; 
  margin-bottom: 12px;
  border: 1px solid;
}
.section h3 { color: white; font-weight: 600; margin-bottom: 10px; font-size: 15px; }
.section ul { list-style: none; }
.section li { color: #cbd5e1; font-size: 13px; margin: 6px 0; }
.scenarios { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 24px; }
.scenario { border-radius: 12px; padding: 24px; border: 2px solid; }
.scenario h3 { color: white; font-size: 18px; font-weight: 700; margin-bottom: 16px; }
.step { display: flex; gap: 10px; margin: 10px 0; color: #e2e8f0; font-size: 14px; align-items: start; }
.step-num { font-weight: 700; min-width: 20px; }
.legend { 
  background: linear-gradient(to right, #1e293b, #0f172a);
  border: 2px solid #475569;
  border-radius: 12px;
  padding: 24px;
}
.legend h3 { color: white; text-align: center; margin-bottom: 16px; font-size: 18px; font-weight: 700; }
.legend-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
.legend-item div:first-child { color: #fb923c; font-weight: 700; margin-bottom: 6px; font-size: 14px; }
.legend-item div:last-child { color: #cbd5e1; font-size: 13px; }
.dataflow { 
  background: linear-gradient(to right, #164e63, #1e3a8a);
  border: 2px solid #06b6d4;
  border-radius: 12px;
  padding: 20px;
}
.dataflow h3 { color: white; text-align: center; margin-bottom: 12px; font-size: 16px; font-weight: 700; }
.flow-item { display: flex; align-items: center; gap: 10px; margin: 10px 0; font-size: 14px; color: #cbd5e1; }
.dot { width: 14px; height: 14px; border-radius: 50%; flex-shrink: 0; }
.transport-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 14px; }
.transport-item { 
  background: #334155; 
  padding: 12px 8px; 
  border-radius: 6px; 
  text-align: center;
}
.transport-item span { display: block; font-size: 12px; color: #cbd5e1; margin-top: 6px; font-weight: 600; }
.btn-container { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000; }
.btn { 
  background: #3b82f6; 
  color: white; 
  padding: 12px 24px; 
  border-radius: 8px; 
  cursor: pointer; 
  border: none; 
  font-size: 14px; 
  font-weight: 600;
  box-shadow: 0 4px 6px rgba(0,0,0,0.4);
}
.btn:hover { background: #2563eb; }
@media print {
  body { padding: 20px; }
  .btn-container { display: none; }
}
</style>
</head>
<body>
<div class="btn-container">
  <button class="btn" onclick="window.print()">💾 Save as PDF</button>
  <button class="btn" onclick="downloadImage()">📷 Download PNG</button>
</div>

<div class="container" id="diagram">
  <div class="header">
    <h1>FASLit System Architecture</h1>
    <p>Eclipse SDV Ecosystem Integration</p>
  </div>
  
  <div class="grid">
    <!-- Vehicle System -->
    <div>
      <div class="card" style="background: linear-gradient(135deg, #1e40af, #1e3a8a); border-color: #60a5fa;">
        <div class="card-header">
          <svg width="32" height="32" fill="none" stroke="#93c5fd" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path>
          </svg>
          <h2 class="card-title">Vehicle System</h2>
        </div>
        
        <div class="section" style="border-color: #3b82f6;">
          <h3>📷 Camera & Sensors</h3>
          <ul>
            <li>• Front/Rear Cameras</li>
            <li>• Event Detection AI</li>
            <li>• Real-time Analysis</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #f97316;">
          <h3>Eclipse Kuksa.VAL</h3>
          <ul>
            <li>• Vehicle Data Broker</li>
            <li>• VSS (Vehicle Signal Spec)</li>
            <li>• Real-time Data Access</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #a855f7;">
          <h3>🚗 Autonomous Driving</h3>
          <ul>
            <li>• Eclipse Agemo (AD Stack)</li>
            <li>• Path Planning</li>
            <li>• Self-parking Mode</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #06b6d4;">
          <h3>📡 V2X Communication</h3>
          <ul>
            <li>• Eclipse uProtocol</li>
            <li>• Event Broadcasting</li>
            <li>• Vehicle Network Mesh</li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Cloud Platform -->
    <div>
      <div class="card" style="background: linear-gradient(135deg, #7c3aed, #6b21a8); border-color: #a78bfa; margin-bottom: 16px;">
        <div class="card-header">
          <svg width="32" height="32" fill="none" stroke="#c4b5fd" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"></path>
          </svg>
          <h2 class="card-title">Cloud Platform</h2>
        </div>
        
        <div class="section" style="border-color: #a855f7;">
          <h3>Event Processing Engine</h3>
          <ul>
            <li>• AI Event Classification</li>
            <li>• Event Severity Analysis</li>
            <li>• Affected Area Calculation</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #3b82f6;">
          <h3>Vehicle Network Manager</h3>
          <ul>
            <li>• Route Intersection Analysis</li>
            <li>• Targeted Alert Distribution</li>
            <li>• Network Synchronization</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #22c55e;">
          <h3>API Integration Hub</h3>
          <ul>
            <li>• Transit Schedules API</li>
            <li>• Ride-sharing Services</li>
            <li>• Mapping Services</li>
            <li>• Route Optimization</li>
          </ul>
        </div>
      </div>
      
      <div class="dataflow">
        <h3>Data Flow</h3>
        <div class="flow-item">
          <div class="dot" style="background: #22c55e;"></div>
          <span>Event Detection → Cloud</span>
        </div>
        <div class="flow-item">
          <div class="dot" style="background: #3b82f6;"></div>
          <span>Cloud → Vehicle Alerts</span>
        </div>
        <div class="flow-item">
          <div class="dot" style="background: #a855f7;"></div>
          <span>Vehicle ↔ Infotainment</span>
        </div>
        <div class="flow-item">
          <div class="dot" style="background: #f97316;"></div>
          <span>Infotainment ↔ Mobile</span>
        </div>
      </div>
    </div>
    
    <!-- User Interfaces -->
    <div>
      <div class="card" style="background: linear-gradient(135deg, #166534, #15803d); border-color: #4ade80; margin-bottom: 16px;">
        <div class="card-header">
          <svg width="32" height="32" fill="none" stroke="#86efac" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
          </svg>
          <h2 class="card-title">Infotainment System</h2>
        </div>
        
        <div class="section" style="border-color: #22c55e;">
          <h3>Eclipse Ankaios/Leda</h3>
          <ul>
            <li>• Container Orchestration</li>
            <li>• App Management</li>
            <li>• UI Framework</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #eab308;">
          <h3>FASLit Dashboard</h3>
          <ul>
            <li>• Live Camera Feed</li>
            <li>• Event Notifications</li>
            <li>• Route Visualization</li>
            <li>• Alternative Options</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #3b82f6;">
          <h3>🚶 Alternative Transport UI</h3>
          <div class="transport-grid">
            <div class="transport-item">
              <div style="font-size: 24px;">🚌</div>
              <span>Transit</span>
            </div>
            <div class="transport-item">
              <div style="font-size: 24px;">🚕</div>
              <span>Ride</span>
            </div>
            <div class="transport-item">
              <div style="font-size: 24px;">🚶</div>
              <span>Walk</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card" style="background: linear-gradient(135deg, #9a3412, #c2410c); border-color: #fb923c;">
        <div class="card-header">
          <svg width="32" height="32" fill="none" stroke="#fdba74" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
          </svg>
          <h2 class="card-title">Mobile Companion App</h2>
        </div>
        
        <div class="section" style="border-color: #f97316;">
          <h3>Core Features</h3>
          <ul>
            <li>• Vehicle Status Tracking</li>
            <li>• Real-time Location</li>
            <li>• Remote Commands</li>
            <li>• Journey Continuation</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #3b82f6;">
          <h3>After Exit Mode</h3>
          <ul>
            <li>• Monitor vehicle to destination</li>
            <li>• Navigation sync</li>
            <li>• Parking confirmation</li>
            <li>• Meet-up coordination</li>
          </ul>
        </div>
        
        <div class="section" style="border-color: #22c55e;">
          <h3>Integration</h3>
          <ul>
            <li>• Transit app links</li>
            <li>• Ride-hailing integration</li>
            <li>• Walking directions</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <div class="scenarios">
    <div class="scenario" style="background: linear-gradient(to right, #7f1d1d, #9a3412); border-color: #f87171;">
      <h3>Scenario 1: Affected Driver</h3>
      <div class="step"><span class="step-num" style="color: #fca5a5;">1.</span><span>Camera detects accident ahead</span></div>
      <div class="step"><span class="step-num" style="color: #fca5a5;">2.</span><span>Event sent to cloud, analyzed & broadcasted</span></div>
      <div class="step"><span class="step-num" style="color: #fca5a5;">3.</span><span>Infotainment shows alternatives with ETAs</span></div>
      <div class="step"><span class="step-num" style="color: #fca5a5;">4.</span><span>Driver selects transit option & exits</span></div>
      <div class="step"><span class="step-num" style="color: #fca5a5;">5.</span><span>Vehicle autonomously continues to destination</span></div>
      <div class="step"><span class="step-num" style="color: #fca5a5;">6.</span><span>Driver tracks vehicle via mobile app</span></div>
    </div>
    
    <div class="scenario" style="background: linear-gradient(to right, #164e63, #0e7490); border-color: #60a5fa;">
      <h3>Scenario 2: Approaching Driver</h3>
      <div class="step"><span class="step-num" style="color: #93c5fd;">1.</span><span>Receives event alert from vehicle network</span></div>
      <div class="step"><span class="step-num" style="color: #93c5fd;">2.</span><span>Cloud analyzes route intersection</span></div>
      <div class="step"><span class="step-num" style="color: #93c5fd;">3.</span><span>Infotainment displays alert with details</span></div>
      <div class="step"><span class="step-num" style="color: #93c5fd;">4.</span><span>Alternative routes calculated & shown</span></div>
      <div class="step"><span class="step-num" style="color: #93c5fd;">5.</span><span>Driver accepts reroute suggestion</span></div>
      <div class="step"><span class="step-num" style="color: #93c5fd;">6.</span><span>Navigation updates, avoids affected area</span></div>
    </div>
  </div>
  
  <div class="legend">
    <h3>Eclipse SDV Components Used</h3>
    <div class="legend-grid">
      <div class="legend-item">
        <div>Eclipse Kuksa.VAL</div>
        <div>Vehicle data abstraction & VSS</div>
      </div>
      <div class="legend-item">
        <div>Eclipse Agemo</div>
        <div>Autonomous driving stack</div>
      </div>
      <div class="legend-item">
        <div>Eclipse uProtocol</div>
        <div>Vehicle communication layer</div>
      </div>
      <div class="legend-item">
        <div>Eclipse Ankaios/Leda</div>
        <div>Container orchestration & IVI</div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
async function downloadImage() {
  const button = event.target;
  button.textContent = 'Generating...';
  button.disabled = true;
  
  try {
    const element = document.getElementById('diagram');
    const canvas = await html2canvas(element, {
      scale: 2,
      backgroundColor: '#0f172a',
      logging: false,
      windowWidth: 1600,
      windowHeight: element.scrollHeight
    });
    
    const link = document.createElement('a');
    link.download = 'faslitarchitecture.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
    
    button.textContent = '✅ Downloaded!';
    setTimeout(() => {
      button.textContent = '📷 Download PNG';
      button.disabled = false;
    }, 2000);
  } catch (error) {
    button.textContent = '❌ Error';
    alert('Screenshot failed. Please use the PDF option or take a screenshot manually.');
    setTimeout(() => {
      button.textContent = '📷 Download PNG';
      button.disabled = false;
    }, 2000);
  }
}
</script>
</body>
</html>